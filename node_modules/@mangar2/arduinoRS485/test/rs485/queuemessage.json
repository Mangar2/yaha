[
    {
        "description": "queue message, get an acknowledge",
        "tests": [
            {
                "description": "goto registered",
                "receive": ["enableSend", 2, 1],
                "messageAmount": 1,
                "expected": [
                    {"value": "enableSend", "sender": 1, "receiver": 2 }
                ]
            },
            {
                "description": "queueMessage",
                "send": ["command", 1, 2],
                "messageAmount": 1,
                "expected": [
                    {"value": "enableSend", "sender": 1, "receiver": 2 }
                ]
            },
            {
                "description": "receive enable send",
                "receive": ["enableSend", 2, 1],
                "messageAmount": 1,
                "expected": [
                    {"value": "command", "sender": 1, "receiver": 2 }
                ]
            },
            {
                "description": "receive nothing",
                "messageAmount": 1,
                "expected": [
                    {"value": "enableSend", "sender": 1, "receiver": 2 }
                ]
            },
            {
                "description": "message is still in the queue",
                "receive": ["enableSend", 2, 1],
                "messageAmount": 1,
                "expected": [
                    {"value": "command", "sender": 1, "receiver": 2 }
                ]
            },
            {
                "description": "receive nothing 2",
                "messageAmount": 1,
                "expected": [
                    {"value": "enableSend", "sender": 1, "receiver": 2 }
                ]
            },
            {
                "description": "receive acknowledge",
                "receive": ["command", 2, 1],
                "messageAmount": 1,
                "expected": [
                    {"value": "enableSend", "sender": 1, "receiver": 2 }
                ]
            },
            {
                "description": "message in no longer in the queue",
                "receive": ["enableSend", 2, 1],
                "messageAmount": 1,
                "expected": [
                    {"value": "enableSend", "sender": 1, "receiver": 2 }
                ]
            }
        ]
    },
    {
        "description": "queue message, get no acknowledge",
        "tests": [
            {
                "description": "goto registered",
                "receive": ["enableSend", 2, 1],
                "messageAmount": 1,
                "expected": [
                    {"value": "enableSend", "sender": 1, "receiver": 2 }
                ]
            },
            {
                "description": "queueMessage",
                "send": ["command", 1, 2],
                "messageAmount": 1,
                "expected": [
                    {"value": "enableSend", "sender": 1, "receiver": 2 }
                ]
            },
            {
                "description": "receive enable send",
                "receive": ["enableSend", 2, 1],
                "messageAmount": 1,
                "expected": [
                    {"value": "command", "sender": 1, "receiver": 2 }
                ]
            },
            {
                "description": "message is still in the queue",
                "receive": ["enableSend", 2, 1],
                "messageAmount": 1,
                "expected": [
                    {"value": "command", "sender": 1, "receiver": 2 }
                ]
            },
            {
                "description": "message is still in the queue 2",
                "receive": ["enableSend", 2, 1],
                "messageAmount": 1,
                "expected": [
                    {"value": "command", "sender": 1, "receiver": 2 }
                ]
            },
            {
                "description": "message is still in the queue 3",
                "receive": ["enableSend", 2, 1],
                "messageAmount": 1,
                "expected": [
                    {"value": "command", "sender": 1, "receiver": 2 }
                ]
            },
            {
                "description": "message is still in the queue 4",
                "receive": ["enableSend", 2, 1],
                "messageAmount": 1,
                "expected": [
                    {"value": "command", "sender": 1, "receiver": 2 }
                ]
            },
            {
                "description": "message is still in the queue 5",
                "receive": ["enableSend", 2, 1],
                "messageAmount": 1,
                "expected": [
                    {"value": "command", "sender": 1, "receiver": 2 }
                ]
            },
            {
                "description": "message is still in the queue 6",
                "receive": ["enableSend", 2, 1],
                "messageAmount": 1,
                "expected": [
                    {"value": "command", "sender": 1, "receiver": 2 }
                ]
            },
            {
                "description": "message is still in the queue 7",
                "receive": ["enableSend", 2, 1],
                "messageAmount": 1,
                "expected": [
                    {"value": "command", "sender": 1, "receiver": 2 }
                ]
            },
            {
                "description": "message is still in the queue 8",
                "receive": ["enableSend", 2, 1],
                "messageAmount": 1,
                "expected": [
                    {"value": "command", "sender": 1, "receiver": 2 }
                ]
            },
            {
                "description": "message is still in the queue 9",
                "receive": ["enableSend", 2, 1],
                "messageAmount": 1,
                "expected": [
                    {"value": "command", "sender": 1, "receiver": 2 }
                ]
            },
            {
                "description": "message in no longer in the queue",
                "receive": ["enableSend", 2, 1],
                "messageAmount": 1,
                "expected": [
                    {"value": "enableSend", "sender": 1, "receiver": 2 }
                ]
            }
        ]
    },
    {
        "description": "queue two messages, get an acknowledge",
        "tests": [
            {
                "description": "goto registered",
                "receive": ["enableSend", 2, 1],
                "messageAmount": 1,
                "expected": [
                    {"value": "enableSend", "sender": 1, "receiver": 2 }
                ]
            },
            {
                "description": "queueMessage",
                "send": ["command", 1, 2],
                "messageAmount": 1,
                "expected": [
                    {"value": "enableSend", "sender": 1, "receiver": 2 }
                ]
            },
            {
                "description": "receive enable send",
                "receive": ["enableSend", 2, 1],
                "messageAmount": 1,
                "expected": [
                    {"value": "command", "sender": 1, "receiver": 2 }
                ]
            },
            {
                "description": "queueMessage to 3",
                "send": ["command", 1, 3],
                "messageAmount": 1,
                "expected": [
                    {"value": "enableSend", "sender": 1, "receiver": 2 }
                ]
            },
            {
                "description": "message is still in the queue",
                "receive": ["enableSend", 2, 1],
                "messageAmount": 1,
                "expected": [
                    {"value": "command", "sender": 1, "receiver": 2 }
                ]
            },
            {
                "description": "receive acknowledge",
                "receive": ["command", 2, 1],
                "messageAmount": 1,
                "expected": [
                    {"value": "enableSend", "sender": 1, "receiver": 2 }
                ]
            },
            {
                "description": "send next message of the queue",
                "receive": ["enableSend", 2, 1],
                "messageAmount": 1,
                "expected": [
                    {"value": "command", "sender": 1, "receiver": 3 }
                ]
            }
        ]
    },
    {
        "description": "queue two messages, seond is replacing first, get an acknowledge",
        "tests": [
            {
                "description": "goto registered",
                "receive": ["enableSend", 2, 1],
                "messageAmount": 1,
                "expected": [
                    {"value": "enableSend", "sender": 1, "receiver": 2 }
                ]
            },
            {
                "description": "queueMessage",
                "send": ["command", 1, 2],
                "messageAmount": 1,
                "expected": [
                    {"value": "enableSend", "sender": 1, "receiver": 2 }
                ]
            },
            {
                "description": "receive enable send",
                "receive": ["enableSend", 2, 1],
                "messageAmount": 1,
                "expected": [
                    {"value": "command", "sender": 1, "receiver": 2 }
                ]
            },
            {
                "description": "replace message",
                "send": ["command", 1, 2],
                "messageAmount": 1,
                "expected": [
                    {"value": "enableSend", "sender": 1, "receiver": 2 }
                ]
            },
            {
                "description": "message is still in the queue",
                "receive": ["enableSend", 2, 1],
                "messageAmount": 1,
                "expected": [
                    {"value": "command", "sender": 1, "receiver": 2 }
                ]
            },
            {
                "description": "receive acknowledge",
                "receive": ["command", 2, 1],
                "messageAmount": 1,
                "expected": [
                    {"value": "enableSend", "sender": 1, "receiver": 2 }
                ]
            },
            {
                "description": "message in no longer in the queue",
                "receive": ["enableSend", 2, 1],
                "messageAmount": 1,
                "expected": [
                    {"value": "enableSend", "sender": 1, "receiver": 2 }
                ]
            }
        ]
    }
]