<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

### Table of Contents

-   -   [Parameters][1]
    -   [Examples][2]
-   [connect][3]
    -   [Parameters][4]
-   [on][5]
    -   [Parameters][6]
-   [run][7]
-   [close][8]

## 

**Meta**

-   **copyright**: Copyright (c) 2020 Volker Böhm

-   **author**: Volker Böhm
-   **license**: This software is licensed under the GNU LESSER GENERAL PUBLIC LICENSE Version 3. It is furnished
    "as is", without any support, and with no warranty, express or implied, as to its usefulness for
    any purpose.

## 

Creates a new broker

### Parameters

-   `configuration` **[Object][9]** configuration (configuration) of the broker
    -   `configuration.port` **([number][10] \| [string][11])** port number the broker will listen on
    -   `configuration.persistInterval` **[number][10]** in milliseconds. Intervall between persisting
        internal state to file
    -   `configuration.connections` **[Object][9]** connection settings for the broker
        -   `configuration.connections.fileName` **[string][11]** filename for persistence
        -   `configuration.connections.directory` **[string][11]** directory (file path) for persistence
        -   `configuration.connections.replyTimeoutInMilliseconds` **[number][10]** timeout to wait for an answer
            of a http call
        -   `configuration.connections.inFlightWindow` **[number][10]** amount of qos 1 and qos 2 messages
            send for the same topic at the same time (optional, default `1`)
        -   `configuration.connections.pubrelTimeoutInMilliseconds` **[number][10]** temeout to wait for a
            corresponding pubrel message (optional, default `oneday`)
        -   `configuration.connections.maxRetryCount` **[number][10]** amount of resend of messages
            before forcing a disconnect
        -   `configuration.connections.maxQueuSize` **[number][10]** maximal amount of entries in a message queue
        -   `configuration.connections.log` **[Object][9]** log settings

### Examples

```javascript
const configuration = {
     port: 10000,
     persistInterval: 0,
     connections: {
          directory: '.',
          fileName: 'broker',
          log: [
              {
                  module: 'received',
                  topic: '#'
              }
          ]
      }
  }
const broker = new Broker(configuration)
broker.run()
```

## connect

Connects to a friendly broker and subscribs for all messages

### Parameters

-   `host` **[string][11]** name of the host (or his ip)
-   `port` **[number][10]** port number to connect to

## on

Sets a callback.

### Parameters

-   `event` **[string][11]** callback name (supports 'send' and 'publish')
    'send' is called to send data. This function is provided by the broker but could be overwritten
    'publish' is called on receiving data. This function if provided by the broker but could be overwritten
-   `callback` **[function][12]** 


-   Throws **[Error][13]** if the event is not supported
-   Throws **[Error][13]** if the callback is not 'function'

## run

Starts the broker. It will listen to message, send messages and periodically store its status

## close

Closes the broker, stops listening

[1]: #parameters

[2]: #examples

[3]: #connect

[4]: #parameters-1

[5]: #on

[6]: #parameters-2

[7]: #run

[8]: #close

[9]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object

[10]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number

[11]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String

[12]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function

[13]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Error
