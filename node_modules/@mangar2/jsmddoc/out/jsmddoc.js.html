<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: jsmddoc.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: jsmddoc.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @license
 * This software is licensed under the GNU LESSER GENERAL PUBLIC LICENSE Version 3. It is furnished
 * "as is", without any support, and with no warranty, express or implied, as to its usefulness for
 * any purpose.
 *
 * @author Volker Böhm
 * @copyright Copyright (c) 2020 Volker Böhm
 * @overview This module provides a parser and a generator to parse JSDOC tags in
 * JavaScript files and generates a markdown based on a user-defined template
 */
'use strict'

const Tokenizer = require('./tokenizer')
const Parse = require('./parse')
const Generate = require('./generate')
const Template = require('./template.json')
const types = require('@mangar2/types')

const fs = require('fs')
const path = require('path')

/**
 * @private
 * @description
 * Gets the command line parameters as object (Key/value)
 * @param {Array} requiredArgs list of required arguments
 * @param {Array} whiteList list of supported additional arguments (--name value)
 * @returns {Object} object with key/value
 */
function getCommandLineParameters (requiredArgs = [], whiteList = []) {
    const result = {}
    const args = [...process.argv]
    let argName
    // remove executable and file
    args.shift()
    args.shift()
    for (const argName of requiredArgs) {
        if (!types.isString(args[0]) || args[0].startsWith('--')) {
            break
        }
        result[argName] = args.shift()
    }
    for (const argument of args) {
        if (argument.startsWith('--')) {
            argName = argument.substring(2)
            result[argName] = ''
        } else if (types.isString(argName) &amp;&amp; whiteList.includes(argName)) {
            result[argName] = argument
        }
    }
    return result
}

/**
 * @private
 * @description
 * Reads a directory and sorts it
 * @param {string} directory directory to read and sort files
 * @returns {promise} sorted list of files
 */
function readDir (directory) {
    const files = fs.readdirSync(directory)
    console.log(files)
    return files
}

const parameters = getCommandLineParameters(['directory', 'outputFile'])

if (parameters.directory === undefined) {
    parameters.directory = __dirname
}

const files = readDir(parameters.directory)
let parseResult

for (const file of files) {
    if (file.endsWith('.js')) {
        const pathAndName = path.join(parameters.directory, file)
        console.log('Parsing file %s', pathAndName)
        const content = fs.readFileSync(pathAndName, 'utf-8')
        const tokenizer = new Tokenizer(file, content)
        const parse = new Parse(tokenizer)
        parseResult = parse.getJSON(parseResult)
    }
}
const generate = new Generate(Template)
const md = generate.generate(parseResult)

if (parameters.outputFile === undefined) {
    console.log(md)
} else {
    fs.writeFileSync(path.join(__dirname, parameters.outputFile), md, { flag: 'w' })
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Generate.html">Generate</a></li><li><a href="Parse.html">Parse</a></li><li><a href="Tokenizer.html">Tokenizer</a></li></ul><h3>Global</h3><ul><li><a href="global.html#_parseAttribute">_parseAttribute</a></li><li><a href="global.html#parseParamLine">parseParamLine</a></li><li><a href="global.html#parseReturns">parseReturns</a></li><li><a href="global.html#parseThrows">parseThrows</a></li><li><a href="global.html#reportError">reportError</a></li><li><a href="global.html#requireToken">requireToken</a></li><li><a href="global.html#test">test</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.3</a> on Sun Mar 29 2020 07:50:36 GMT+0200 (GMT+02:00)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
