/**
 * ---------------------------------------------------------------------------------------------------
 * This software is licensed under the GNU LESSER GENERAL PUBLIC LICENSE Version 3. It is furnished
 * "as is", without any support, and with no warranty, express or implied, as to its usefulness for
 * any purpose.
 *
 * File:      test.js
 *
 * Author:      Volker Böhm
 * Copyright:   Volker Böhm
 * ---------------------------------------------------------------------------------------------------
 */
'use strict'

const LogFilter = require('@mangar2/logfilter')
const UnitTest = require('@mangar2/unittest')

const logFilter = new LogFilter()
const unitTest = new UnitTest()

logFilter.changePattern([
    {
        module: 'send',
        topic: '/a/send',
        level: 1
    },
    {
        module: 'received',
        topic: '/a/received',
        level: 2
    },
    {
        module: 'all',
        topic: '/a/all',
        level: 3
    },
    {
        module: 'send',
        topic: '/a/all',
        level: 1
    },
    {
        module: 'any',
        topic: '/a/any',
        level: 0
    }
])

unitTest.assertEqual(logFilter.getLogLevel('send', '/a/send'), 1, 'send 1')
unitTest.assertFalse(logFilter.getLogLevel('send', '/a/received'), 'send 2')

unitTest.assertEqual(logFilter.getLogLevel('received', '/a/received'), 2, 'received 1')
unitTest.assertFalse(logFilter.getLogLevel('received', '/a/send'), 'received 2')

unitTest.assertEqual(logFilter.getLogLevel('send', '/a/all'), 3, 'all 1')
unitTest.assertEqual(logFilter.getLogLevel('received', '/a/all'), 3, 'all 2')

unitTest.assertFalse(logFilter.getLogLevel('send', '/a/any'), 'any')
unitTest.assertFalse(logFilter.getLogLevel('received', '/a/any'), 'any')

unitTest.showResult(8)
process.exit(0)
