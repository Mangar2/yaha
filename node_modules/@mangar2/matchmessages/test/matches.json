[
    {
        "description": "Basic matches",
        "incomingMessages": [[ "a/b/set", 1, "test1" ]],
        "tests": [
            {
                "description": "Not matching shorter topic",
                "outgoingMessage": [ "a", 1, "reply1" ],
                "expected": { "topic": "a", "value": 1, "reason": ["reply1"] }
            },
            {
                "description": "Not matching longer topic",
                "outgoingMessage": [ "a/b/c", 1, "reply1" ],
                "expected": { "topic": "a/b/c", "value": 1, "reason": ["reply1"] }
            },
            {
                "description": "Not matching if having action",
                "outgoingMessage": [ "a/b/set", 1, "reply1" ],
                "expected": { "topic": "a/b/set", "value": 1, "reason": ["reply1"] }
            },
            {
                "description": "Matches identical topic",
                "outgoingMessage": [ "a/b", 1, "reply1" ],
                "expected": { "topic": "a/b", "value": 1, "reason": ["test1", "reply1"] }
            },
            {
                "description": "Not matching twice",
                "outgoingMessage": [ "a/b", 1, "reply1" ],
                "expected": { "reason": ["reply1"] }
            }
        ]
    },
    {
        "description": "Wrong value removes the incoming message",
        "incomingMessages": [[ "a/b/set", 1, "test1" ]],
        "tests": [
            {
                "description": "Not matching different value",
                "outgoingMessage": [ "a/b", 2, "reply1" ],
                "expected": { "topic": "a/b", "value": 2, "reason": ["reply1"] }
            },
            {
                "description": "Not matching after identical topic with different value",
                "outgoingMessage": [ "a/b", 1, "reply1" ],
                "expected": { "reason": ["reply1"] }
            }
        ]
    },
    {
        "description": "Matching actions",
        "incomingMessages": [
            [ "a/a/get", 1, "test1" ],
            [ "a/b/set", 2, "test2" ],
            [ "a/c/temporary", 3, "test3" ],
            [ "a/d/blink", 4, "test4" ]
        ],
        "tests": [
            {
                "description": "get",
                "outgoingMessage": [ "a/a", 1, "reply1" ],
                "expected": { "value": 1, "reason": ["test1", "reply1"] }
            },
            {
                "description": "set",
                "outgoingMessage": [ "a/b", 2, "reply2" ],
                "expected": { "value": 2, "reason": ["test2", "reply2"] }
            },
            {
                "description": "temporary",
                "outgoingMessage": [ "a/c", 3, "reply3" ],
                "expected": { "reason": ["test3", "reply3"] }
            },
            {
                "description": "blink",
                "outgoingMessage": [ "a/d", 4, "reply4" ],
                "expected": { "reason": ["test4", "reply4"] }
            }
        ]
    },
    {
        "description": "Not matching actions",
        "incomingMessages": [
            [ "a/a/set1", 1, "test1" ],
            [ "a/b", 1, "test1" ]
        ],
        "tests": [
            {
                "description": "wrongly written action",
                "outgoingMessage": [ "a/a", 1, "reply1" ],
                "expected": { "reason": ["reply1"] }
            },
            {
                "description": "no action",
                "outgoingMessage": [ "a/b", 1, "reply1" ],
                "expected": { "reason": ["reply1"] }
            }

        ]
    }
    ,
    {
        "description": "matching vaues in different format",
        "incomingMessages": [
            [ "a/a/set", "1", "test1" ],
            [ "a/b/set", 1, "test2" ],
            [ "a/c/set", "1.0", "test3" ],
            [ "a/d/set", "off", "test4" ]
        ],
        "tests": [
            {
                "description": "string matches number",
                "outgoingMessage": [ "a/a", 1, "reply1" ],
                "expected": { "reason": ["test1", "reply1"] }
            },
            {
                "description": "number matches string",
                "outgoingMessage": [ "a/b", "1", "reply1" ],
                "expected": { "reason": ["test2", "reply1"] }
            },
            {
                "description": "Different number format does match",
                "outgoingMessage": [ "a/c", 1, "reply1" ],
                "expected": { "reason": ["test3", "reply1"] }
            },
            {
                "description": "Different strings do not match",
                "outgoingMessage": [ "a/b", "on", "reply1" ],
                "expected": { "reason": ["reply1"] }
            }

        ]
    }
]