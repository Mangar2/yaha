<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

### Table of Contents

-   [MessageNode][1]
    -   [Properties][2]
-   [MessageTree][3]
    -   [Parameters][4]
    -   [persist][5]
        -   [Parameters][6]
    -   [readTreeFromPersistedFile][7]
        -   [Parameters][8]
    -   [getNode][9]
        -   [Parameters][10]
    -   [getAndCreateDataNode][11]
        -   [Parameters][12]
    -   [addData][13]
        -   [Parameters][14]
    -   [getSection][15]
        -   [Parameters][16]
    -   [updateContent][17]
        -   [Parameters][18]
-   [LENGTH_TO_CHECK_FOR_SHORTER_NOTATION][19]
-   [addToHistory][20]
    -   [Parameters][21]
-   [Reason][22]
    -   [Properties][23]
-   [Decompressed][24]
    -   [Properties][25]
-   [decompress][26]
    -   [Parameters][27]

## 

**Meta**

-   **copyright**: Copyright (c) 2020 Volker Böhm

-   **author**: Volker Böhm
-   **license**: This software is licensed under the GNU LESSER GENERAL PUBLIC LICENSE Version 3. It is furnished
    "as is", without any support, and with no warranty, express or implied, as to its usefulness for
    any purpose.

## MessageNode

Type: [Object][28]

### Properties

-   `time` **[number][29]** timestamp of node creation
-   `value` **[number][29]** node value
-   `reason` **[Reason][30]** node reason
-   `history` **[History][31]** node history
-   `childs` **[Map][32]** map of child names to child.

## MessageTree

Data structure holding a large amount of messages with topic, value and reason in a tree organized according the topic.
Each tree node containing data provides a "history" including recent messages.
It includes several methods to "compress" the history of messages of each topic

### Parameters

-   `options` **[Object][28]** options for the tree
    -   `options.maxHistoryLength` **[number][29]** maximum amount of entries in the history array
    -   `options.maxValuesLength` **[number][29]** maximum amount of values per history entry
    -   `options.historyHysterese` **[number][29]** hysterese to cut history length
    -   `options.upperBoundFactor` **[number][29]** upper bound to compare time spans (for inteval based compression)
    -   `options.upperBoundAddInMilliseconds` **[number][29]** upper bound add to compare time spans
    -   `options.lowerBoundFactor` **[number][29]** , lower bound factor to compare time spans
    -   `options.lowerBoundSubInMilliseconds` **[number][29]** lower bound sub to compare time spans

### persist

Persists all connections

#### Parameters

-   `directory` **[string][33]** directory of the files
-   `filenameBasis` **[string][33]** basis filename, a timestamp is added

### readTreeFromPersistedFile

Reads the tree from a persisted file

#### Parameters

-   `directory` **[string][33]** directory of the files
-   `filenameBasis` **[string][33]** basis filename, a timestamp is added

### getNode

Searches a node in the message tree corresponding to the topic.

#### Parameters

-   `topic` **[string][33]** topic to store the data

Returns **[Object][28]** data to store

### getAndCreateDataNode

Searches a node in the message tree corresponding to the topic. Creates empty nodes along the topic if
the nodes are not yet available.

#### Parameters

-   `topic` **[string][33]** topic to store the data

Returns **[Object][28]** node in the tree

### addData

Adds data to the three node matching to the topic path.
It will store the current time, data and descrition to the node and
the former time and data entry is copied to the history array property.

#### Parameters

-   `message` **Message** {topic, value, reason}
    -   `message.topic` **[string][33]** topic string
    -   `message.value` **objecObjectt** value of the topic
    -   `message.reason` **[Array][34]&lt;[Object][28]>** list of reasons

### getSection

Gets several levels of child nodes in one flat object structure

#### Parameters

-   `topic` **[string][33]** start topic of the section
-   `levelAmount` **[number][29]** amount of levels to get
-   `addHistory` **[boolean][35]** true, if the history property will be added (optional, default `true`)

Returns **{topics: [Array][34], payload: [Object][28]}** Object with topics and payloads of all nodes in output format
for these (sub)topics

### updateContent

Updates the data of a node and stores the old data to a history array.
The new history entry is added to the beginning of the queue. If the history length exceeds the
maximal length, it will be reduces by "historyHysterese" amount of elements

#### Parameters

-   `node` **[Object][28]** node to update
-   `content` **[Object][28]** new content of the node
-   `options` **[Object][28]** options to organize the history

## 

**Meta**

-   **copyright**: Copyright (c) 2020 Volker Böhm

-   **author**: Volker Böhm
-   **license**: This software is licensed under the GNU LESSER GENERAL PUBLIC LICENSE Version 3. It is furnished
    "as is", without any support, and with no warranty, express or implied, as to its usefulness for
    any purpose.

## LENGTH_TO_CHECK_FOR_SHORTER_NOTATION

Length of history entry array (time/value pairs) until the algorithm will try to compress it
to a shorter notation (remove values, if they are always equal or even store one the amount of equal values)

Type: [number][29]

## addToHistory

Adds an entry to the history and possible add it or join it with the latest history entry

### Parameters

-   `history` **[Array][34]&lt;[Object][28]>** history list
    -   `history[].type` **[string][33]?** type of the entry ('single', 'timeValue', 'time', 'interval)
    -   `history[].time` **[number][29]?** timestamp of the second entry (only type 'single')
    -   `history[].value` **[number][29]?** value of the first entry (only types 'single', 'time', 'interval')
    -   `history[].reason` **[Array][34]&lt;[Object][28]>** list of reasons
    -   `history[].timeValue` **[Array][34]&lt;[Object][28]>?** array of [time, value] \(only type 'timeValue')
    -   `history[].timestamps` **[Array][34]&lt;[number][29]>?** array of timestamps (only type 'time')
    -   `history[].amount` **[number][29]?** amount of entries joined before (only type 'interval')
    -   `history[].firstTime` **[number][29]?** timestamp the value was encountered first (only type 'interval')
    -   `history[].lastTime` **[number][29]?** timestamp the value was encoutered last (only type 'interval')
-   `entryToAdd` **[Object][28]** first entry
    -   `entryToAdd.time` **[number][29]** timestamp of the first entry
    -   `entryToAdd.value` **[Object][28]** value of the first entry
    -   `entryToAdd.reason` **[Array][34]&lt;[Object][28]>** list of reasons
-   `options` **[Object][28]** options to calculate the bounds
    -   `options.upperBoundFactor` **[number][29]** factor to multiply the joined interval for the upper bound
    -   `options.upperBoundAddInMilliseconds` **[number][29]** constant to add to the joined interval for the upper bound
    -   `options.lowerBoundFactor` **[number][29]** factor to multiply the joined interval for the lower bound
    -   `options.lowerBoundSubInMilliseconds` **[number][29]** constant to sub from the joined interval for the lower bound
    -   `options.maxHistoryLength` **[number][29]** maximal amount of entries in the history
    -   `options.historyHysterese` **[number][29]** amount of entries to delete, if history exeeds max length

Returns **[Array][34]&lt;[Object][28]>** new history (array of entries)

## 

**Meta**

-   **copyright**: Copyright (c) 2020 Volker Böhm

-   **author**: Volker Böhm
-   **license**: This software is licensed under the GNU LESSER GENERAL PUBLIC LICENSE Version 3. It is furnished
    "as is", without any support, and with no warranty, express or implied, as to its usefulness for
    any purpose.

## Reason

Type: [Array][34]&lt;[Object][28]>

### Properties

-   `message` **[string][33]** description of the event reason
-   `time` **[string][33]** timestamp the event happened in ISO-Format

## Decompressed

Type: [Object][28]

### Properties

-   `value` **[number][29]** value of the entry
-   `time` **[string][33]** time the value was received (ISO-Format)
-   `reason` **[Reason][30]?** array of reason information

## decompress

Decomresses a history entry to an external format

### Parameters

-   `history` **[Array][34]&lt;[Object][28]>** history list
    -   `history[].type` **[string][33]?** type of the entry ('single', 'timeValue', 'time', 'interval)
    -   `history[].time` **[number][29]?** timestamp of the second entry (only type 'single')
    -   `history[].value` **[number][29]?** value of the first entry (only types 'single', 'time', 'interval')
    -   `history[].reason` **[Array][34]&lt;[Object][28]>** list of reasons
    -   `history[].values` **[Array][34]&lt;[Object][28]>?** array of [time, value] \(only type 'timeValue')
    -   `history[].timestamps` **[Array][34]&lt;[number][29]>?** array of timestamps (only type 'time')
    -   `history[].amount` **[number][29]?** amount of entries joined before (only type 'interval')
    -   `history[].firstTime` **[number][29]?** timestamp the value was encountered first (only type 'interval')
    -   `history[].lastTime` **[number][29]?** timestamp the value was encoutered last (only type 'interval')

Returns **[Array][34]&lt;[Decompressed][36]>** array of decompressed history entries

[1]: #messagenode

[2]: #properties

[3]: #messagetree

[4]: #parameters

[5]: #persist

[6]: #parameters-1

[7]: #readtreefrompersistedfile

[8]: #parameters-2

[9]: #getnode

[10]: #parameters-3

[11]: #getandcreatedatanode

[12]: #parameters-4

[13]: #adddata

[14]: #parameters-5

[15]: #getsection

[16]: #parameters-6

[17]: #updatecontent

[18]: #parameters-7

[19]: #length_to_check_for_shorter_notation

[20]: #addtohistory

[21]: #parameters-8

[22]: #reason

[23]: #properties-1

[24]: #decompressed

[25]: #properties-2

[26]: #decompress

[27]: #parameters-9

[28]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object

[29]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number

[30]: #reason

[31]: https://developer.mozilla.org/docs/Web/Guide/API/DOM/Manipulating_the_browser_history

[32]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Map

[33]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String

[34]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array

[35]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean

[36]: #decompressed
