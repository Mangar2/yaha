<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

### Table of Contents

-   [{Mqtt~sendCallback} 'send'][1]
    -   [Parameters][2]
-   [Mqtt][3]
    -   [Parameters][4]
    -   [restoreFromFile][5]
    -   [on][6]
        -   [Parameters][7]
    -   [processRequest][8]
        -   [Parameters][9]
    -   [getConnections][10]
        -   [Parameters][11]
    -   [processSendMessage][12]
-   [{Mqtt~publishCallback} 'publish'][13]
    -   [Parameters][14]

## 

**Meta**

-   **copyright**: Copyright (c) 2020 Volker Böhm

-   **author**: Volker Böhm
-   **license**: This software is licensed under the GNU LESSER GENERAL PUBLIC LICENSE Version 3. It is furnished
    "as is", without any support, and with no warranty, express or implied, as to its usefulness for
    any purpose.

## {Mqtt~sendCallback} 'send'

Type: [Function][15]

### Parameters

-   `host` **[string][16]** host name
-   `port` **([number][17] \| [string][16])** number
-   `path` **[string][16]** http path for sending data
-   `payload` **[Object][18]** payload (body) to send
-   `headers` **[Object][18]** headers to send

## Mqtt

Main Mqtt message handler, receives, checks, transforms and foreward messages
It supports the callbacks 'send' and 'publish'

### Parameters

-   `configuration` **[Object][18]** configuration options for the instance
    -   `configuration.log` **[Object][18]** logging options
    -   `configuration.fileName` **[string][16]** filename for persistence
    -   `configuration.directory` **[string][16]** directory (file path) for persistence
    -   `configuration.replyTimeoutInMilliseconds` **[number][17]** timeout to wait for an answer
        of a http call, default 10 seconds
    -   `configuration.inFlightWindow` **[number][17]** amount of qos 1 and qos 2 messages
        send for the same topic at the same time, default 1
    -   `configuration.pubrelTimeoutInMilliseconds` **[number][17]** timout to wait for a
        corresponding pubrel message, default one day
    -   `configuration.maxRetryCount` **[number][17]** amount of resend of messages
        before forcing a disconnect
    -   `configuration.maxQueuSize` **[number][17]** maximal amount of entries in a message queue

### restoreFromFile

Restores the broker state from a file

### on

Sets a callback.

#### Parameters

-   `event` **[string][16]** callback name (supports 'send' and 'publish')
-   `callback` **[function][15]** 


-   Throws **[Error][19]** if the event is not supported
-   Throws **[Error][19]** if the callback is not 'function'

### processRequest

Calls a connection interface

#### Parameters

-   `controls` **[string][16]** name of the mqtt controls to call (connect, disconnect, ...)
-   `payload` **[Object][18]** parameters for the interface (see interfaces)
-   `headers` **[Object][18]** headers of the http message

Returns **{headers: [Object][18], payload: [Object][18], statusCode: [number][17]}** http result objects

### getConnections

Gets all connections or a single connection (depends on path)

#### Parameters

-   `clientId` **[string][16]** id of the client or ""

Returns **{headers: [Object][18], payload: [Object][18], statusCode: [number][17]}** http result objects

### processSendMessage

Processes all messages to send and for each message calls the provided callback functions registered by calls to 'on':
'send' (host, port, action, payload, headers)

Returns **[number][17]** amount of messages sent

## {Mqtt~publishCallback} 'publish'

Type: [Function][15]

### Parameters

-   `message` **Message** message published

[1]: #mqttsendcallback-send

[2]: #parameters

[3]: #mqtt

[4]: #parameters-1

[5]: #restorefromfile

[6]: #on

[7]: #parameters-2

[8]: #processrequest

[9]: #parameters-3

[10]: #getconnections

[11]: #parameters-4

[12]: #processsendmessage

[13]: #mqttpublishcallback-publish

[14]: #parameters-5

[15]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function

[16]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String

[17]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number

[18]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object

[19]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Error
