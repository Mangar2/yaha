<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

### Table of Contents

-   [LogPattern][1]
    -   [Properties][2]
-   [MqttClient][3]
    -   [Parameters][4]
    -   [token][5]
    -   [token][6]
        -   [Parameters][7]
    -   [connected][8]
    -   [shutdown][9]
    -   [version][10]
    -   [publish][11]
        -   [Parameters][12]
    -   [on][13]
        -   [Parameters][14]
    -   [run][15]
    -   [close][16]
    -   [reconnect][17]
    -   [registerRecipient][18]
        -   [Parameters][19]
    -   [registerSender][20]
        -   [Parameters][21]

## 

**Meta**

-   **copyright**: Copyright (c) 2020 Volker Böhm

-   **author**: Volker Böhm
-   **license**: This software is licensed under the GNU LESSER GENERAL PUBLIC LICENSE Version 3. It is furnished
    "as is", without any support, and with no warranty, express or implied, as to its usefulness for
    any purpose.

## LogPattern

Type: [Object][22]

### Properties

-   `pattern` **[string][23]** log topic pattern
-   `module` **[string][23]** module to log, "send", "receive" or "all" (for all modules)
-   `level` **[number][24]** log level for the pattern

## MqttClient

Creates a standard mqtt client, connects and subscribes to the broker

### Parameters

-   `options` **[Object][22]** options to provide for connection
    -   `options.clientId` **[string][23]** unique id of the client
    -   `options.broker` **[Object][22]** information of the broker to connect to
        -   `options.broker.host` **[string][23]** hostname of the broker
        -   `options.broker.port` **[number][24]** port of the broker
    -   `options.listener` **[number][24]** port this client will listen to
    -   `options.version` **[string][23]** interface version (optional, default `'1.0'`)
    -   `options.keepAliveInSeconds` **[string][23]?** connection keep alive time in seconds
    -   `options.clean` **[boolean][25]** clean the broker session on disconnect (optional, default `true`)
    -   `options.retry` **[number][24]** amount of retries to send messages to the broker
    -   `options.log` **[Array][26]&lt;[LogPattern][27]>** logging settings

### token

Gets a token

Returns **[Object][22]** object with send and receive tokens

### token

Sets a token

#### Parameters

-   `token`  
    -   `token.send` **[string][23]** send token
    -   `token.receive` **[string][23]** receive token

### connected

Gets/Sets connection status

Type: [boolean][25]

### shutdown

Gets/Sets shutdown status. shutdown is cleared in the contructor and
set in the shutdown function. Every loop must stop once shutdown is true

Type: [boolean][25]

### version

Gets/Sets the interface version to use

Type: [string][23]

### publish

Publishes a message to the broker

#### Parameters

-   `message` **Message** message to publish
-   `qos` **[number][24]** quality of service (0,1,2) (optional, default `0`)
-   `retain` **[boolean][25]** true to create a retain message (optional, default `false`)

### on

Sets a callback.

#### Parameters

-   `event` **[string][23]** supports 'shutdown'
-   `callback` **[function][28]** 


-   Throws **[Error][29]** if the event is not supported
-   Throws **[Error][29]** if the callback is not 'function'

### run

Starts the mqttclient. Opens the listener and connects to the broker

### close

closes the client by shutting down all services and loops

### reconnect

Connects and subscribes to the broker

### registerRecipient

Registeres a recipient

#### Parameters

-   `subscriptions` **[Object][22]** subscription entries of format {topic:qos, topic:qos, ...}
-   `callback` **[function][28]** function to send received messages to


-   Throws **[Error][29]** If subscriptions are not well formatted or callback is not a function

### registerSender

Registeres a service sending messages in intervals. The service must provide a function (callback)
without parameters returing an array of messages. The messages will then be sent to the broker

#### Parameters

-   `intervalInMilliseconds` **[number][24]** interval in milliseconds to call the senders callback
-   `callback` **function ()** function to call, must return an array of messages

[1]: #logpattern

[2]: #properties

[3]: #mqttclient

[4]: #parameters

[5]: #token

[6]: #token-1

[7]: #parameters-1

[8]: #connected

[9]: #shutdown

[10]: #version

[11]: #publish

[12]: #parameters-2

[13]: #on

[14]: #parameters-3

[15]: #run

[16]: #close

[17]: #reconnect

[18]: #registerrecipient

[19]: #parameters-4

[20]: #registersender

[21]: #parameters-5

[22]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object

[23]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String

[24]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number

[25]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean

[26]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array

[27]: #logpattern

[28]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function

[29]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Error
