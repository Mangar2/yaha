<!-- This file is generated by jsmddoc version 0.1 -->

# Abstract

Interface to the opensense map service . Use it to send data to opensense map .

## Contents

- [Meta](#Meta)
- [Type definitions](#Type-definitions)
- [Global Functions](#Global-functions)
  - [getSubscriptions](#getSubscriptions)
  - [publish](#publish)

## Meta

| | |
| --- | --- |
| **File** | opensensemap.js |
| **Abstract** | Interface to the opensense map service . Use it to send data to opensense map . |
| **Author** | Volker Böhm |
| **Copyright** | Copyright ( c ) 2020 Volker Böhm |
| **License** | This software is licensed under the GNU LESSER GENERAL PUBLIC LICENSE Version 3 . It is furnished "as is" , without any support , and with no warranty , express or implied , as to its usefulness for any purpose . |

## Type definitions

### Sensor {Object}

| Name | Type | Description |
| ---- | ---- | ------- |
| `name` | `string` | name of the sensor | |
| `unit` | `string` | unit of the sensor | |
| `topic` | `string` | topic the sensor is matched to | |
| `id` | `string` | opensensmap unique id | |

### Sensors {Array.<Sensor>}


## Global functions

### getSubscriptions

`getSubscriptions (config) => {Array.<string>}`

Gets the subscriptions for the service

#### getSubscriptions Parameters

| Name | Type | Description |
| ---------- | ------------ | ----------------- |
| `config` | `Object` | configuration ( sensors , . . . ) | |

#### config properties

| Name | Type | Description |
| ---------- | ------------ | ----------------- |
| `sensors` | `Sensors` | opensensemap sensor configuration | |
| `qos` | `number` | quality of service for message transport | |

#### getSubscriptions returns

| Type | Description |
| ---- | ----------- |
| `Array.<string>` | array of subscriptions |

### publish

`async publish (message, config) => {Message}`

Publishes a value to opensensemap ( you need an account to do this ) Publish data provided as Message to opensensemap . You need an account on opensensemap . org The message topic is mapped to the sensor id provided in the config object . The message value it the value to publish

#### Example

```javascript
const config =
{
  "station" : "your station name (optional)",
  "id" : "your station id",
  "host": "ingress.opensensemap.org",
  "port": 443,
  "sensors": [{
          "name": "temperature",
          "uint": "°C",
          "topic" : "topic/used/for/the/sensor",
          "id": "your sensor id"
   }]
}
let result = await Opensensemap.publish(
   new Message('topic/used/for/the/sensor', 2.61, 'test value' },
   config
)
```

#### publish Parameters

| Name | Type | Description |
| ---------- | ------------ | ----------------- |
| `message` | `Message` | the data to publish on the opensensemap | |
| `config` | `Object` | configuration ( sensors , . . . ) | |

#### message properties

| Name | Type | Description |
| ---------- | ------------ | ----------------- |
| `topic` | `string` | the topic is used to select the sensor id from config | |
| `value` | `number` | the value to publish to the sensor | |

#### config properties

| Name | Type | Attribute | Default | Description |
| ---------- | ------------ | ------------ | ------------ | ----------------- |
| `station` | `string` | optional |  | name of the station | |
| `id` | `string` |  |  | sensebox id ( provided by open sens map ) | |
| `host` | `string` |  |  | host of open sense map | |
| `port` | `port` | optional | 443 | portnumer of open sense map ( usually 443 ) | |
| `sensors` | `Sensors` |  |  | opensensemap sensor configuration | |

#### publish returns

| Type | Description |
| ---- | ----------- |
| `Message` | message containing the status . Send it back to the broker |
