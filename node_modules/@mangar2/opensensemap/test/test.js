/**
 * ---------------------------------------------------------------------------------------------------
 * This software is licensed under the GNU LESSER GENERAL PUBLIC LICENSE Version 3. It is furnished
 * "as is", without any support, and with no warranty, express or implied, as to its usefulness for
 * any purpose.
 *
 * File:      test.js
 *
 * Author:      Volker Böhm
 * Copyright:   Volker Böhm
 * ---------------------------------------------------------------------------------------------------
 */

'use strict'

const Opensensemap = require('@mangar2/opensensemap')

const configExample = {
    development: {
        opensensemap: {
            id: 'your+id',
            host: 'ingress.opensensemap.org',
            port: 443,
            sensors: [{
                name: 'temperature',
                uint: 'Â°C',
                topic: 'your/topic',
                id: 'your+id'
            }
            ]
        }
    }
}

console.log('This test needs a valid configuration, it will not run without change')
// path to your configuration file
const allConfig = require('c:/programming/yaha/yahaconfig.json')
const config = require('@mangar2/config')(allConfig).opensensemap;

(async () => {
    let result = await Opensensemap.publish(
        { topic: 'your/topic', value: 2.61, reason: [{ message: 'test1' }] },
        configExample.development.opensensemap
    )
    console.log(result)
    result = await Opensensemap.publish(
        { topic: 'outdoor/garden/main/weather/temperature', value: 2.61, reason: [{ message: 'test2' }] },
        config
    )
    console.log(result)
    console.log(Opensensemap.getSubscriptions(config))
    console.log('success')
})()
