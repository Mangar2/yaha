<!-- This file is generated by jsmddoc version 0.1 -->

# Abstract

Service to run operating system commands remotely and continuously send keep alive messages . It is used to include computers in the yaha home automation system . It can for example be used to shutdown a computer . Then switch of the power remotely once keep alive messages are no longer received . For security , it will only support remote commands configured in a configuration file , it will not directly process message content ( send as string ) on a remote computer .

## Installation

Install the package globally with node package manager

```Script
npm i @mangar2/remotecontrol -g
```

## Behaviour

If you add then "remotecontrol" to your autoexec bat, the pc is integrated in the yaha home automation. The Broker will receive messages with the value 'alive' as long as the system is up and running.

- Sending YOURTOPIC/set with value = 'hibernate' will hibernate the computer with a delay of 60 seconds.
- Sending YOURTIOIC/set with value = 'stop' will stop hibernation

Add then an automation rule to the yaha automation service to automate anything base on the state of the pc. Remove the pc safely from power, if you have for example a remote controllable switch to remove the power from your pc. Switch power back on to start your computer automatically. Do not forget to enable "bool on power on" in the BIOS or your computer

Add more commands to integrate more features. For example add a backup command and then steer backups form your home automation. As an example, wake up the computer and the backup-system at 2:00 a.m., start the backup, and hibernate both systems once the backup is finished.

## Configuration

Many options are "preconfigured", but you need to add some configuration options manually. Add a "yahaconfig.json" file to the direcotry and add the following configuration"

```JSON
{
    "production": {
        "remoteControl": {
            "subscribeTopic":  "add/your/topic/string/here",
            "clientId": "ThisIsAUniqueClientId"
        }
    }
}
```

### subscribeTopic

Add the topic string to scbscribe to your yaha broker. The remotecontrol will subscribe with the topic + '/set' and thus receive all commands changing the status of your pc. The remotecontrol service will then reply with a message having this topic without the /set appendix to inform about the new status.

### clientId

Unique identifier of your client. You can give it a user-friendly name here.

## Default Configuration

Add any of the following configuration options to your yahaconfig.json file to change the default settings:

```JSON
{
    "version": "1.0",
    "clean": true,
    "broker": {
        "port": 8183,
        "host": "127.0.0.1"
    },
    "listener": 8205,
    "keepAliveInSeconds": 600,
    "log": [
        {
            "module": "send",
            "topic": "#",
            "level": 1
        },
        {
            "module": "all",
            "topic": "$SYS/#",
            "level": 0
        }
    ],
    "subscribeQoS": 1,
    "statusIntervalInSeconds": 60,
    "commands": [
        {
            "name": "hibernate",
            "command": "shutdown /h",
            "delayInSeconds": 60,
            "value": "hibernate"
        }
    ]
}
```
