[
    {
        "description": "normal rule",
        "rule": {
            "time": "8:00",
            "cooldownInSeconds": 300,
            "topic": "cooldown",
            "value": "off"
        },
        "tests": [
            {
                "description": "activate at 8:00",
                "time": "8:00",
                "expected": { "messages": [{ "topic": "cooldown", "value": "off"}] }
            },
            {
                "description": "no cooldown",
                "time": "8:04",
                "expected": { "messages": [] }
            },
            {
                "description": "still no cooldown",
                "time": "8:03",
                "expected": { "messages": [] }
            },
            {
                "description": "cooldown",
                "time": "8:05",
                "expected": { "messages": [{ "topic": "cooldown" }]}
            },
            {
                "description": "seconds cooldown",
                "time": "8:05",
                "expected": { "messages": [] }
            },
            {
                "description": "still second cooldown",
                "time": "8:09",
                "expected": { "messages": [] }
            },
            {
                "description": "third activation",
                "time": "8:10",
                "expected": { "messages": [{ "topic": "cooldown" }] }
            },
            {
                "description": "fourth activation",
                "time": "8:15",
                "expected": { "messages": [{ "topic": "cooldown" }] }
            }
        ]
    },
    {
        "description": "event rule",
        "rule": {
            "time": "8:00",
            "cooldownInSeconds": 300,
            "allOf": ["/required1"],
            "topic": "cooldown",
            "value": "off"
        },
        "tests": [
            {
                "description": "activate at 8:00",
                "time": "8:00",
                "motionEvents": ["/required1"],
                "expected": { "messages": [{ "topic": "cooldown", "value": "off" }] }
            },
            {
                "description": "no cooldown",
                "time": "8:04",
                "motionEvents": ["/required1"],
                "expected": { "messages": [] }
            },
            {
                "description": "still no cooldown",
                "time": "8:03",
                "motionEvents": ["/required1"],
                "expected": { "messages": [] }
            },
            {
                "description": "cooldown",
                "time": "8:05",
                "motionEvents": ["/required1"],
                "expected": { "messages": [{ "topic": "cooldown", "value": "off" }] }
            }
        ]
    },
    {
        "description": "rules triggered by motionEvents will activate on every event",
        "rule": {
            "time": "8:00",
            "allOf": ["/required1"],
            "topic": "cooldown",
            "value": "off"
        },
        "tests": [
            {
                "description": "activate at 8:00",
                "time": "8:00",
                "motionEvents": ["/required1"],
                "expected": { "messages": [{ "topic": "cooldown", "value": "off" }] }
            },
            {
                "description": "no cooldown",
                "time": "8:04",
                "motionEvents": ["/required1"],
                "expected": { "messages": [{ "topic": "cooldown", "value": "off" }] }
            },
            {
                "description": "still no cooldown",
                "time": "8:03",
                "motionEvents": ["/required1"],
                "expected": { "messages": [{ "topic": "cooldown", "value": "off" }] }
            }
        ]
    },
    {
        "description": "Non event rules will only trigger once",
        "rule": {
            "time": "8:00",
            "topic": "cooldown",
            "value": "off"
        },
        "tests": [
            {
                "description": "activate at 8:00",
                "time": "8:00",
                "motionEvents": ["/required1"],
                "expected": { "messages": [{ "topic": "cooldown", "value": "off" }] }
            },
            {
                "description": "no cooldown",
                "time": "8:04",
                "motionEvents": ["/required1"],
                "expected": { "messages": [] }
            },
            {
                "description": "still no cooldown",
                "time": "8:03",
                "motionEvents": ["/required1"],
                "expected": { "messages": [] }
            }
        ]
    },
    {
        "description": "rule with time value",
        "rule": {
            "time": "8:00",
            "cooldownInSeconds": 300,
            "topic": "cooldown",
            "value": "/time"
        },
        "tests": [
            {
                "description": "activate at 8:00",
                "time": "8:00",
                "expected": { 
                    "messages": [{ "topic": "cooldown", "value": "<time>" }],
                    "usedVariables": {
                        "/time": "<time>"
                    }
                }
            },
            {
                "description": "no cooldown",
                "time": "8:04",
                "expected": { "messages": [] }
            },
            {
                "description": "still no cooldown",
                "time": "8:03",
                "expected": { "messages": [] }
            },
            {
                "description": "cooldown",
                "time": "8:05",
                "expected": { "messages": [{ "topic": "cooldown", "value": "<time>" }] }
            },
            {
                "description": "seconds cooldown",
                "time": "8:05",
                "expected": { "messages": [] }
            },
            {
                "description": "still second cooldown",
                "time": "8:09",
                "expected": { "messages": [] }
            },
            {
                "description": "third activation",
                "time": "8:10",
                "expected": { "messages": [{ "topic": "cooldown", "value": "<time>" }] }
            },
            {
                "description": "fourth activation",
                "time": "8:15",
                "expected": { "messages": [{ "topic": "cooldown", "value": "<time>" }] }
            }
        ]
    }
]
