[
    {
        "description": "normal rule",
        "rule": {
            "time": "8:00",
            "delayInSeconds": 300,
            "topic": "delay",
            "value": "off"
        },
        "tests": [
            {
                "description": "Too early at 8:00",
                "time": "8:00",
                "expected": { "messages": [] }
            },
            {
                "description": "Still too early at 8:04",
                "time": "8:04",
                "expected": { "messages": [] }
            },
            {
                "description": "Still too early at 8:03",
                "time": "8:03",
                "expected": { "messages": [] }
            },
            {
                "description": "Still too early at 8:05",
                "time": "8:05",
                "expected": { "messages": [] }
            },
            {
                "description": "Not too early any more",
                "time": "8:06",
                "expected": { "messages": [{ "topic": "delay", "value": "off" }] }
            },
            {
                "description": "sent only once",
                "time": "8:09",
                "expected": { "messages": [] }
            },
            {
                "description": "still sent only once",
                "time": "8:10",
                "expected": { "messages": [] }
            }
        ]
    },
    {
        "description": "value changing",
        "rule": {
            "time": "8:00",
            "delayInSeconds": 300,
            "topic": "delay",
            "value": ["and", [">=", "/time", "8:10"], ["<=", "/time", "8:20"]]
        },
        "tests": [
            {
                "description": "Too early at 8:00",
                "time": "8:00",
                "expected": { "messages": [] }
            },
            {
                "description": "Triggers at 8:06",
                "time": "8:06",
                "expected": { "messages": [{ "topic": "delay", "value": false }] }
            },
            {
                "description": "Value change, but no trigger at 8:10",
                "time": "8:10",
                "expected": { "messages": [] }
            },
            {
                "description": "Still too early at 8:15",
                "time": "8:15",
                "expected": { "messages": [] }
            },
            {
                "description": "Now with other value",
                "time": "8:19",
                "expected": { "messages": [{ "topic": "delay", "value": true }] }
            },
            {
                "description": "First of old value",
                "time": "8:21",
                "expected": { "messages": [] }
            },
            {
                "description": "Not too early, old value",
                "time": "8:29",
                "expected": { "messages": [{ "topic": "delay", "value": false }] }
            }
        ]
    }
]