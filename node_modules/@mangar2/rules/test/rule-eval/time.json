[
    {
        "description": "constant time",
        "rule": {
            "time": "8:00",
            "topic": "topic",
            "value": "off",
            "cooldownInSeconds": 0
        },
        "tests": [
            {
                "description": "activate at 8:00",
                "time": "8:00",
                "expected": { "messages": [{ "topic": "topic", "value": "off"}] }
            },
            {
                "description": "activate at 10:00",
                "time": "10:00",
                "expected": { "messages": [{ "topic": "topic", "value": "off"}] }
            },
            {
                "description": "too late",
                "time": "22:00",
                "expected": { "messages": [] }
            },
            {
                "description": "too early",
                "time": "07:59",
                "expected": { "messages": [] }
            }
        ]
    },
    {
        "description": "constant time with duration",
        "rule": {
            "time": "8:00",
            "duration": "2:00",
            "topic": "topic",
            "value": "off",
            "cooldownInSeconds": 0
        },
        "tests": [
            {
                "description": "activate at 9:59",
                "time": "9:59",
                "expected": { "messages": [{ "topic": "topic", "value": "off"}] }
            },
            {
                "description": "too late",
                "time": "10:00",
                "expected": { "messages": [] }
            }
        ]
    },
    {
        "description": "calculated time",
        "rule": {
            "time": ["switch", "/variable", { "one": "8:00", "two": "9:00" }],
           "topic": "topic", 
           "value": "off", 
           "cooldownInSeconds": 0
        },
        "tests": [
            {
                "description": "variable is one ",
                "variables": {"/variable": "one"},
                "time": "8:00",
                "expected": { "messages": [{ "topic": "topic", "value": "off"}] }
            },
            {
                "description": "variable is two ",
                "variables": {"/variable": "two"},
                "time": "8:00",
                "expected": { "messages": [] }
            },
            {
                "description": "variable is two, late enough ",
                "variables": {"/variable": "two"},
                "time": "9:00",
                "expected": { "messages": [{ "topic": "topic", "value": "off"}] }
            },
            {
                "description": "variable is three, 9:00",
                "variables": {"/variable": "three"},
                "time": "9:00",
                "expected": { "messages": [] }
            },
            {
                "description": "variable is three, 0:00",
                "variables": {"/variable": "three"},
                "time": "0:00",
                "expected": { "messages": [] }
            },
            {
                "description": "variable is three, 23:00",
                "variables": {"/variable": "three"},
                "time": "23:00",
                "expected": { "messages": [] }
            }
        ]
    },
    {
        "description": "undefined calculation for time",
        "rule": {
            "time": ["switch", "/variable", { "one": "8:00", "two": "9:00" }],
            "topic": "topic",
            "value": "off"
        },
        "tests": [
            {
                "description": "undefined time, should never trigger",
                "variables": {"/variable": "three"},
                "time": "10:00",
                "expected": { "messages": [] }
            }
        ]
    },
    {
        "description": "duration without movement & time",
        "rule": {
            "time": "21:00",
            "duration": "8:00",
            "check": ["=", "$SYS/presence", "awake"],
            "durationWithoutMovementInMinutes": 15,
            "topic": ["$SYS/presence", "system/presence"],
            "value": "sleeping",
            "cooldownInSeconds": 0
        },
        "tests": [
            {
                "description": "variable provided ",
                "variables": {"$SYS/presence": "awake"},
                "time": "21:00",
                "cooldownInSeconds": 0,
                "expected": { "messages": [
                    { "topic": "$SYS/presence", "value": "sleeping" }, 
                    { "topic": "system/presence", "value": "sleeping" }
                ] }
            }
        ]
    }

]
