<!-- This file is generated by jsmddoc version 0.1 -->

# Abstract

Provides a storage for Message trees and provides a rest interface to get chunks of the message tree

## Contents

- [Meta](#Meta)
- [Global Functions](#Global-functions)
  - [prepare](#prepare)
- [Class MessageStore](#Class-MessageStore)
  - [Parameters](#MessageStore-Parameters)
  - [Members](#MessageStore-Members)
  - [Methods](#MessageStore-Methods)
    - [close](#close)
    - [getSubscriptions](#getSubscriptions)
    - [handleMessage](#handleMessage)
    - [run](#run)

## Meta

| | |
| --- | --- |
| **File** | messagestore.js |
| **Abstract** | Provides a storage for Message trees and provides a rest interface to get chunks of the message tree |
| **Author** | Volker Böhm |
| **Copyright** | Copyright ( c ) 2020 Volker Böhm |
| **License** | This software is licensed under the GNU LESSER GENERAL PUBLIC LICENSE Version 3 . It is furnished "as is" , without any support , and with no warranty , express or implied , as to its usefulness for any purpose . |

## Global functions

### prepare

`prepare (config, messagestore) => {MessageStore}`

Prepares the object

#### prepare Parameters

| Name | Type | Attribute | Default | Description |
| ---------- | ------------ | ------------ | ------------ | ----------------- |
| `config` | `Object` |  |  | automation configuration | |
| `messagestore` | `MessageStore` | optional | null | existing automation class | |

#### prepare returns

| Type | Description |
| ---- | ----------- |
| `MessageStore` | the prepared automation object |

## Class MessageStore

`new MessageStore(options)`

Creates a message store object and configures it . Adds a listener for get requests

### MessageStore Parameters

| Name | Type | Attribute | Default | Description |
| ---------- | ------------ | ------------ | ------------ | ----------------- |
| `options` | `Object` | optional | { } | message store parameters | |

### MessageStore Members

| Name | Type | description |
| ------------ | ------------ | ------------ |
| `messages` | `MessageTree` | Tree of messages |

### MessageStore Methods

#### close

`async close ()`

Closes the broker , stops listening

#### getSubscriptions

`getSubscriptions () => {Object}`

Gets the required subscriptions for the Messagestore

##### getSubscriptions returns

| Type | Description |
| ---- | ----------- |
| `Object` | topic pattern : QoS value key/value object |

#### handleMessage

`handleMessage (message)`

Adds a message to the tree node matching to the topic path .

##### handleMessage Parameters

| Name | Type | Description |
| ---------- | ------------ | ----------------- |
| `message` | `Message` | { topic , value , reason } | |

#### message properties

| Name | Type | Description |
| ---------- | ------------ | ----------------- |
| `topic` | `string` | topic string | |
| `value` | `Object` | value of the topic | |
| `reason` | `Array.<Object>` | list of reasons | |

#### run

`run ()`

Listens to a configured port
