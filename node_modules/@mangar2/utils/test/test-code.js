/**
 * @license
 * This software is licensed under the GNU LESSER GENERAL PUBLIC LICENSE Version 3. It is furnished
 * "as is", without any support, and with no warranty, express or implied, as to its usefulness for
 * any purpose.
 *
 * @author Volker Böhm
 * @copyright Copyright (c) 2020 Volker Böhm
 */

'use strict'

const { UnitTest } = require('@mangar2/unittest')


const tests = [
    '@mangar2/utils/test/test-types',
    '@mangar2/utils/test/test-callbacks',
    '@mangar2/utils/test/test-retry',
    '@mangar2/utils/test/test-taskqueue',
    '@mangar2/utils/test/test-delay',
    '@mangar2/utils/test/test-shutdown'
]

const showResult = async () => {
    require('./test-errorLog')
    for (let test of tests) {
        const testFunction = require(test)
        console.log(`running ${test}`)
        const { showResult } = await testFunction()
        showResult()
    }
}

const getResult = async () => {
    const results = []
    for (let test of tests) {
        const testFunction = require(test)
        console.log(`running ${test}`)
        const { getResult } = await testFunction()
        results.push(getResult())
    }
    return UnitTest.joinMultipleResults(...results)
}

module.exports = {
    showResult: async () => await showResult(),
    getResult: async() => await getResult()
}
